# 超大量ファイル整理 w/ Win32 API
This document is also available in [English](Readme_en.md).

大量のファイルを指定した単位でフォルダに一括整理するシンプルなソフトウェアです。

# 動作要件
## Windows PC版
**Microsoft Windows XP Service Pack 3以降** を推奨

## Windows CE版
**SHARP Brain PW-SH1 (Windows Embedded CE 6.0, ARMv4I)** で動作確認を行っています。それ以外の端末は所持しておらず動作確認できていませんが、IDEが対応するCPU用のコンパイルは行っています。

なお、**SHARP Brainにおいても新しい機種では実行できない場合があります**。対応機種等の情報は[Brain Wiki](https://brain.fandom.com/ja)等のWebサイトを参考にしてください。また、日本語で使用する場合は、電子辞書の日本語化が必要です。

## Batch File版
**Windows PC** で動作確認を行っています。

# 実行手順
実行ファイルは **Releases** から取得できます。
## Windows PC版
**FileSeparating.exe** が実行ファイルです。

Avast!アンチウイルスなど、一部のマルウェア対策ソフトではBCCでコンパイルされたプログラムをマルウェアと誤検出する場合があります。その場合は、チェストから復元するなりして実行すれば大丈夫です(心配ならソースコードを確認してください)。

## Windows CE版
「**Windows CE**」にあります。

**SHARP Brain**の場合は、内蔵メモリーやSDカードの**最上層に「アプリ」フォルダ、その中に「超大量ファイル整理」のようなフォルダを作成し、その中に一連のファイルをコピー**することで「追加アプリ・動画」から実行できるようになります(Other CPUフォルダは不要)。すでに「アプリ」フォルダがある場合は、その中で大丈夫です。適当な位置に配置し、ceOpenerやExplorer等から起動することも可能です。

**SHARP Brain以外の端末**の場合は、ARMv4Iの端末ならSHARP Brainと同じ実行ファイル(.binや.cfgは不要)を､別のCPUの端末なら「Other CPU」フォルダから適切なものを選び、端末所定の方法で実行してください｡なお、製作者はSHARP Brainしか所持していないため、動作確認や動作の保証はできません。

ファイルの数が極端に多い場合、処理完了後にプログラムが落ちることがあるかもしれませんが、その場合でも整理処理自体は正常に完了しているため、問題はない...はずです。

## Batch File版
整理を実行したいフォルダで実行し、指示に従って入力すると整理処理が実行されます。

# 使い方
1. 整理したいパスをフルパスで指定します。入力ボックスの右のボタンから、フォルダを選択することもできます。
1. 整理したいファイル名をワイルドカードを使用して指定します。例えば、すべてのファイルを対象とする場合は「\*」、mp3ファイルのみを対象とする場合は「\*.mp3」と入力します。
1. 何ファイル単位に振り分けるかを指定します。
1. 以上の設定を確認して、OKまたはEnterキーを押します。

起動時の言語は、PC版ではご利用のOSのUI言語に合わせて日本語か英語が選択されるようになっています。CE版ではその関数が使えなかったため毎回英語で起動します。オプションのLanguageから言語の切り替えが可能です。

なお、電子辞書において数値入力は、画面に用意してあるボタンを使っても入力できますし、電子辞書自体のキーボード(アルファベット入力状態のままでOK)でも入力できます。

基本的には辞書順に振り分けられるはずです。「中断」ボタンで中断できますが、**既に振り分けられたファイルを元に戻す機能はありません**。**必ず事前に付属のSandboxフォルダ(空ファイルを100個入れたテスト用空間)などで動作を確認してください。**

# インストール・アンインストールについて
このソフトウェアはインストール不要です。削除も、そのまま実行ファイルを削除するだけで大丈夫です。レジストリなどは使用していません。

# ソースコードについて
ビルド方法などは各プロジェクトフォルダ内のreadmeを参照してください。

# 使用上の注意
**製作者は、このプログラムの利用によって生じた、いかなる損害についても責任を負いません。**

# 著作権情報など
このソフトウェアはフリーソフトウェアですが、製作者は著作権を放棄しておりませんので、**無断転載は禁止**です。しかし、このプログラムを参考にして作成した全く別のソフトウェアに関しては、製作者が著作権を主張することはございませんので、自由に制作・配布いただいて構いません。

製作者: watamario, otwthutu15(AtSign)gmail.com

# 既知の問題
    日本語入力モードでエディットボックスに入力すると、その間動作が止まったりフリーズすることがある。

とりあえずの対応: **パスは貼り付け、それ以外は半角入力モードで入力が最もやりやすいと思います。一応日本語入力も、入力されていないように見えますが、変換キーで変換、Enterキーで決定すると表示されるので一応可能です。**

    Windows 10 のクリップボード履歴機能から貼り付けようとすると、アプリケーションが操作不能になる。

とりあえずの対応: **別のアプリの入力画面などを用いて、Ctrl+Vで貼り付けられる状態にして貼り付けてください。**

    Windows 10 May 2020 Update で導入された新バージョンのIMEを使用している環境では、エディットボックスに入力が行えず、操作不能になる。

とりあえずの対応: **設定から旧バージョンのIMEを使用するように変更してください[(参照)](https://support.microsoft.com/ja-jp/help/4564002/you-might-have-issues-on-windows-10-version-2004-when-using-some-micro)。** (2020年9月現在、この新IMEには多数の問題が存在するようです)

これらの問題点は、原因が判明次第修正の予定ですが、現在修正方法が分かっていません。ご存じの方がいらっしゃいましたら、情報提供してくださるとありがたいです。

# 変更履歴
## v1.1 (2020/9/28)
正式リリース

## v1.1β (2020/9/19)
処理スレッドの優先順位を、PC版でも1段階下げた(CE版では元からこの設定にしてあった)。

日本語と英語の両対応にした。それに伴い、文字列はリソースのString Tableに移動した。

その他、細かい部分を修正・調整した。

## v1.02β (2020/9/2)
プログラムを全体的に見直し、効率化及びプログラムの可読性向上を図った。

Windows CE版(v1.01)での変更点をPC版にも適用した。

PC版もUnicodeビルドに切り替えた。

## v1.01 (2020/3/26) // Windows CE版のみ
フォルダ選択ダイアログを使えるようにした(ceshell.dllの必要な関数が使える場合のみ)

起動時や処理後などに対象パス入力ボックスにフォーカスが当たるようにした

分割単位欄をアルファベット入力モードのまま数字入力できるようにした

コマンドバーを追加した

Enterでフォーカス移動・処理実行できるようにした

ARMv4I以外もとりあえずビルドした

## v1 (2019/4/21)
初回リリース